% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods.R
\name{QDM}
\alias{QDM}
\title{Quantile Delta Mapping}
\usage{
QDM(obs, mod, var, frq, pp_threshold, pp_factor, rel_change_th, inv_mod_th)
}
\arguments{
\item{obs}{A column vector of monthly or annual observed data (temperature or precipitation). If monthly frequency is specified, the length of this vector is 12 times the number of observed years \link{12 x y_obs, 1}. If annual frequency is specified, the length of this vector is equal to the number of observed years \link{y_obs, 1}.}

\item{mod}{A column vector of monthly or annual modeled data (temperature or precipitation). If monthly frequency is specified, the length of this vector is 12 times the number of observed years \link{12 x y_mod, 1}. If annual frequency is specified, the length of this vector is equal to the number of observed years \link{y_mod, 1}.}

\item{var}{A flag that identifies if data are temperature or precipitation. This flag tells the getDist function if it has to discard distribution functions that allow negative numbers, and if the terms in the correction equations are multiplied/divided or added/subtracted. Temperature:   var = 0; Precipitation: var = 1}

\item{frq}{(Optional) A string specifying if the input is annual or monthly data. If not specified, it is set monthly as default. Monthly:   frq = 'M'; Annual:    frq = 'A'}

\item{pp_threshold}{(Optional) A float indicating the threshold to consider physically null precipitation values.}

\item{pp_factor}{(Optional) A float indicating the maximum value of the random values that replace physically null precipitation values.}

\item{rel_change_th}{(Optional) A float indicating the maximum scaling factor (Equation 4 of Cannon et al. (2015)) when the denominator is below inv_mod_th.}

\item{inv_mod_th}{(Optional) A float indicating the upper threshold of the denominator of the scaling factor (Equation 4 of Cannon et al. (2015)) to truncate the scaling factor. This parameter is defined as default as the pp_threshold parameter, described above.}
}
\value{
A column vector of monthly or annual modeled data (temperature or precipitation) corrected by the QDM method. If monthly frequency is specified, the length of this vector is 12 times the number of observed years \link{12 x y_mod, 1}. If annual frequency is specified, the length of this vector is equal to the number of observed  years \link{y_mod, 1}.
}
\description{
This function performs bias correction of modeled series based on observed data by the Quantile Delta Mapping (QDM) method, as described by Cannon et al.  (2015). Correction is performed to monthly or annual precipitation or temperature data in a single location. An independent probability distribution function is assigned to each month and to each projected period based on the Kolmogorov-Smirnov test. If annual frequency is specified, this is applied to the complete period. Each projected period  considers a window whose length is equal to the number of years of the historical period and ends in the analyzed year. Correction of the historical period is performed by the Quantile Mapping (QM) method, as described by Cannon et al. (2015).
}
\details{
Cannon, A. J., S. R. Sobie, and T. Q. Murdock, 2015: Bias correction of GCM precipitation by quantile mapping: How well do methods preserve changes in quantiles and extremes? J. Climate, 28(17), 6938-6959, https://doi.org/10.1175/JCLI-D-14-00754.1
}
\examples{
QDM(obs,mod,var)
QDM(obs,mod,var,frq='A')
QDM(obs,mod,var,frq='M')
QDM(obs,mod,var,frq='M',pp_threshold=0.1)
QDM(obs,mod,var,frq='M',pp_factor=1/1000)
QDM(obs,mod,var,frq='M',pp_threshold=0.1,pp_factor=1/1000)
QDM(obs,mod,var,frq='M',rel_change_th=4)
QDM(obs,mod,var,frq='M',inv_mod_th=1/10)
QDM(obs,mod,var,frq='M',rel_change_th=4,inv_mod_th=1/10)
}
