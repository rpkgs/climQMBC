<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Quantile Mapping functions — map_DQM • climQMBC2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Quantile Mapping functions — map_DQM"><meta property="og:description" content="

Detrended Quantile Mapping (DQM): Cannon et al. (2015).



Quantile Delta Mapping (QDM): Cannon et al. (2015).



Quantile Mapping (QM): Cannon et al. (2015).



Scaled Distribution Mapping (SDM):
Proposed by Switanek et al. (2017). The historical period of the modeled
series is bias corrected as a scenario where the complete series is replaced
by the bias corrected series. On the other hand, for each year after the
historical period the method considers a projected period as a window whose
length is equal to the number of years of the historical period and ends in
the analyzed year. From the bias corrected series, only the last year is
saved and all the others are discarded. This approach aims to build a
continuum for the bias corrected series.



Unbiased Quantile Mapping (UQM): Chadwick et al. (2021).

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">climQMBC2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/DQM.html">DQM</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quantile Mapping functions</h1>
    
    <div class="hidden name"><code>map_QM.Rd</code></div>
    </div>

    <div class="ref-description">
    
<ul><li><p>Detrended Quantile Mapping (DQM): Cannon et al. (2015).</p></li>
</ul><ul><li><p>Quantile Delta Mapping (QDM): Cannon et al. (2015).</p></li>
</ul><ul><li><p>Quantile Mapping (QM): Cannon et al. (2015).</p></li>
</ul><ul><li><p>Scaled Distribution Mapping (SDM):</p>
<p>Proposed by Switanek et al. (2017). The historical period of the modeled
series is bias corrected as a scenario where the complete series is replaced
by the bias corrected series. On the other hand, for each year after the
historical period the method considers a projected period as a window whose
length is equal to the number of years of the historical period and ends in
the analyzed year. From the bias corrected series, only the last year is
saved and all the others are discarded. This approach aims to build a
continuum for the bias corrected series.</p></li>
</ul><ul><li><p>Unbiased Quantile Mapping (UQM): Chadwick et al. (2021).</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">map_DQM</span><span class="op">(</span><span class="va">obs</span>, <span class="va">mod</span>, <span class="va">var</span>, frq <span class="op">=</span> <span class="st">"M"</span>, pp_threshold <span class="op">=</span> <span class="fl">1</span>, pp_factor <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">map_QDM</span><span class="op">(</span></span>
<span>  <span class="va">obs</span>,</span>
<span>  <span class="va">mod</span>,</span>
<span>  <span class="va">var</span>,</span>
<span>  frq <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>  pp_threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pp_factor <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  rel_change_th <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  inv_mod_th <span class="op">=</span> <span class="va">pp_threshold</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">map_QM</span><span class="op">(</span><span class="va">obs</span>, <span class="va">mod</span>, <span class="va">var</span>, frq <span class="op">=</span> <span class="st">"M"</span>, pp_threshold <span class="op">=</span> <span class="fl">1</span>, pp_factor <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">map_SDM</span><span class="op">(</span><span class="va">obs</span>, <span class="va">mod</span>, <span class="va">var</span>, frq <span class="op">=</span> <span class="st">"M"</span>, pp_threshold <span class="op">=</span> <span class="fl">1</span>, pp_factor <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">map_UQM</span><span class="op">(</span><span class="va">obs</span>, <span class="va">mod</span>, <span class="va">var</span>, frq <span class="op">=</span> <span class="st">"M"</span>, pp_threshold <span class="op">=</span> <span class="fl">1</span>, pp_factor <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obs, mod</dt>
<dd><p>A column vector of monthly or annual observed (modeled) data
(temperature or precipitation).</p>
<p>If monthly frequency is specified, the length of this vector is 12 times the
number of years <code>[12 x ny]</code>.</p>
<p>If annual frequency is specified, the length of this vector is equal to the
number of years <code>[ny]</code>.</p></dd>


<dt>var</dt>
<dd><p>A flag that identifies if data are temperature or precipitation.
This flag tells the getDist function if it has to discard distribution
functions that allow negative numbers, and if the terms in the correction
equations are multiplied/divided or added/subtracted.</p><ul><li><p><code>Temperature</code>  : <code>var = 0</code>;</p></li>
<li><p><code>Precipitation</code>: <code>var = 1</code>.</p></li>
</ul></dd>


<dt>frq</dt>
<dd><p>A string specifying if the input is annual or monthly data. If not
specified, it is set monthly as default. Monthly: <code>frq = 'M'</code>; Annual: <code>frq = 'A'</code></p></dd>


<dt>pp_threshold</dt>
<dd><p>A float indicating the threshold to consider physically
null precipitation values.</p></dd>


<dt>pp_factor</dt>
<dd><p>A float indicating the maximum value of the random values
that replace physically null precipitation values.</p></dd>


<dt>rel_change_th</dt>
<dd><p>(Optional) A float indicating the maximum scaling factor
(Eq. 4 of Cannon et al. (2015)) when the denominator is below inv_mod_th.</p></dd>


<dt>inv_mod_th</dt>
<dd><p>(Optional) A float indicating the upper threshold of the
denominator of the scaling factor (Eq. 4 of Cannon et al. (2015)) to truncate
the scaling factor. This parameter is defined as default as the pp_threshold
parameter, described above.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A column vector of monthly or annual modeled data (temperature or
precipitation) corrected by the QM method.</p><ul><li><p>If monthly frequency is specified, the length of this vector is 12 times
the number of observed years <code>[12 x nyear_mod, 1]</code>.</p></li>
<li><p>If annual frequency is specified, the length of this vector is the number
of observed  years <code>[nyear_mod, 1]</code>.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Correction is performed to monthly or annual precipitation or
temperature data in a single location. An independent probability
distribution function is assigned to each month and to each projected period
based on the Kolmogorov-Smirnov test.</p>
<p><em>For DQM, QDM, and UQM:</em></p>
<p>If annual frequency is specified, this is applied to the complete period.
Each projected period considers a window whose length is equal to the number
of years of the historical period and ends in the analyzed year.</p>
<p>Correction of the historical period is performed by the Quantile Mapping (QM)
method, as described by Cannon et al. (2015).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>1.Cannon, A. J., S. R. Sobie, and T. Q. Murdock, 2015: Bias correction of GCM
precipitation by quantile mapping: How well do methods preserve changes in
quantiles and extremes? J. Climate, 28(17), 6938-6959,
https://doi.org/10.1175/JCLI-D-14-00754.1</p>
<p>3.Switanek, B. M., Troch, P., Castro, L. C., Leuprecht, A., Chang, H. I.,
Mukherjee, R., and Demaria, M. C. E. (2017) Scaled distribution mapping: A
bias correction method that preserves raw climate model projected changes.
Hydrology &amp; Earth System Sciences, 21, 2649-2666,
https://doi.org/10.5194/hess-21-2649-2017.</p>
<p>2.Chadwick et al. (2022) <code>[under revision]</code></p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Aedo.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

