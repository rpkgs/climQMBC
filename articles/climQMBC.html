<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>climQMBC • climQMBC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="climQMBC">
<meta property="og:description" content="climQMBC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">climQMBC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/climQMBC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>climQMBC</h1>
            
      
      
      <div class="hidden name"><code>climQMBC.Rmd</code></div>

    </div>

    
    
<p>We hope this script will help the user understand how to use the main
functionalities of the climQMBC package. Alongside this script, in a
folder called Sample_data, the user will find sample datasets for
monthly precipitation (mm) and mean temperature (C). The datasets
include modeled and observed data. The files name structure is
xxx_yyy.csv, where xxx can be mod or obs for modeled or observed data,
respectively, and yyy can be tmp or pp for temperature or precipitation
data, respectively. The historical period of the sample datasets begin
in 1979 and has a length of 36 years (1979 to 2014, including both
years), and the modeled period begins in 1979 and has a length of 122
years (1979 to 2100, including both years).</p>
<p>This script is divided into three examples. The first two examples
can be used to evaluate the performance of each bias correction method
available in the climQMBC package.</p>
<p>Example 1 shows how to use the report function with the minimum
number of inputs. The five methods available in the climQMBC package
will be reported, and the future projected windows displayed are the
first period after the historical period and the last period before the
end of the modeled period. Remember that the projected periods length is
equal to the length of the historical period.</p>
<p>Example 2 shows how to use the report function for specific bias
correction methods and projected periods. The Quantile Delta Mapping
(QDM), Unbiased Quantile Mapping (UQM), and Scaled Distribution Mapping
(SDM) methods will be reported. The report will analyze the projected
periods centered in 2035 2060 and 2080.</p>
<p>Example 3 shows how each bias correction method available in the
climQMBC package should be called. The outputs of each function are
columns vector with monthly corrected data.</p>
<blockquote>
<p>Written by Sebastian Aedo Quililongo (1*) Cristian Chadwick (2)
Fernando Gonzalez-Leiva (3) Jorge Gironas (3)</p>
<ol style="list-style-type: decimal">
<li>Centro de Cambio Global UC, Pontificia Universidad Catolica de
Chile, Santiago, Chile</li>
<li>Faculty of Engineering and Sciences, Universidad Adolfo Ibanez,
Santiago, Chile</li>
<li>Department of Hydraulics and Environmental Engineering, Pontificia
Universidad Catolica de Chile, Santiago, Chile</li>
</ol>
<p>*Maintainer contact: <a href="mailto:slaedo@uc.cl" class="email">slaedo@uc.cl</a> Revision: 0, updated Dec 2021</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::load_all()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">climQMBC</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue" class="external-link">glue</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load observed and model data. Remember that for temperature, var = 0, and</span></span>
<span><span class="co"># for precipitation, var = 1.</span></span>
<span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">var</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">agg</span> <span class="op">&lt;-</span> <span class="va">sum</span></span>
<span>  <span class="va">var_txt</span> <span class="op">&lt;-</span> <span class="st">'pp'</span> </span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">var_txt</span> <span class="op">&lt;-</span> <span class="st">'tmax'</span> </span>
<span>  <span class="va">agg</span> <span class="op">&lt;-</span> <span class="va">mean</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"data-raw/obs_{var_txt}.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"climQMBC"</span><span class="op">)</span></span>
<span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">$</span><span class="va">V1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"data-raw/mod_{var_txt}.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"climQMBC"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">$</span><span class="va">V1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h2>
<p>Example 1 shows how to use the report function with the minimum
number of inputs. The five methods available in the climQMBC package
will be reported, and the future projected windows displayed are the
first period after the historical period and the last period before the
end of the modeled period. Remember that the projected periods length is
equal to the length of the historical period.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rep_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report</a></span><span class="op">(</span><span class="va">obs</span>, <span class="va">mod</span>, <span class="va">var</span><span class="op">)</span></span>
<span><span class="co">#&gt; Description of this report: </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Description of the table </span></span>
<span><span class="co">#&gt; The first line shows the difference (relative or absolute, according </span></span>
<span><span class="co">#&gt; to the variable analyzed) between the QM method and the observed data </span></span>
<span><span class="co">#&gt; in the historical period. For precipitation, a value of 1 means that </span></span>
<span><span class="co">#&gt; the mean precipitation of the observed data and QM series are the same </span></span>
<span><span class="co">#&gt; for the historical period. For temperature, this is achieved with a </span></span>
<span><span class="co">#&gt; value of 0. The second line shows the headers of the periods reported. </span></span>
<span><span class="co">#&gt; Remember that the moving window is centered in the period and its </span></span>
<span><span class="co">#&gt; length is equal to the length of the historical period. The first  </span></span>
<span><span class="co">#&gt; column (Hist.) shows the difference between the future and the </span></span>
<span><span class="co">#&gt; historical period. The next columns show the difference between the </span></span>
<span><span class="co">#&gt; corresponding period and the historical period. The third and the </span></span>
<span><span class="co">#&gt; following lines show the difference in each period for the </span></span>
<span><span class="co">#&gt; corresponding series. As a general rule, it is desirable that the </span></span>
<span><span class="co">#&gt; difference between the future periods and the historical period of the </span></span>
<span><span class="co">#&gt; bias corrected series match the differences of the modeled series. </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Description of the figures </span></span>
<span><span class="co">#&gt; Figure 1: (left) shows the cumulative distribution functions of each </span></span>
<span><span class="co">#&gt; series split between historical and future period. (right) shows the </span></span>
<span><span class="co">#&gt; observed, modeled, and corrected series. </span></span>
<span><span class="co">#&gt; Figure 2: shows the monthly mean of the historical and future period. </span></span>
<span><span class="co">#&gt; Additionally, monthly mean of the projected periods is displayed. </span></span>
<span><span class="co">#&gt; Figure 3: shows the monthly standard deviation of the historical and </span></span>
<span><span class="co">#&gt; future period. Additionally, monthly mean of the projected periods is </span></span>
<span><span class="co">#&gt; displayed. </span></span>
<span><span class="co">#&gt; * In Fig. 2 and 3, the obj (red) line represents objective values. </span></span>
<span><span class="co">#&gt; This objective series is computed as the observed series (monthly mean </span></span>
<span><span class="co">#&gt; or standard deviation), scaled by the variation between the projected </span></span>
<span><span class="co">#&gt; and the historical period of the modeled series. Each projected period </span></span>
<span><span class="co">#&gt; is centered in  a moving window whose length is equal to the length of </span></span>
<span><span class="co">#&gt; the historical period. </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Mean </span></span>
<span><span class="co">#&gt; QM performance in historical period  :     1.001 </span></span>
<span><span class="co">#&gt; Variation              Hist.        First        Last </span></span>
<span><span class="co">#&gt; Modeled          :     0.761   ;    0.892   ;    0.648 </span></span>
<span><span class="co">#&gt; QM               :     0.694   ;    0.857   ;    0.554 </span></span>
<span><span class="co">#&gt; DQM              :     0.751   ;    0.879   ;    0.648 </span></span>
<span><span class="co">#&gt; QDM              :     0.752   ;    0.878   ;    0.649 </span></span>
<span><span class="co">#&gt; UQM              :     0.744   ;    0.876   ;    0.637 </span></span>
<span><span class="co">#&gt; SDM              :     0.750   ;    0.876   ;    0.639 </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Standard deviation </span></span>
<span><span class="co">#&gt; QM performance in historical period  :     0.990 </span></span>
<span><span class="co">#&gt; Variation              Hist.        First        Last </span></span>
<span><span class="co">#&gt; Modeled          :     0.843   ;    0.933   ;    0.735 </span></span>
<span><span class="co">#&gt; QM               :     0.837   ;    0.922   ;    0.703 </span></span>
<span><span class="co">#&gt; DQM              :     0.871   ;    0.936   ;    0.778 </span></span>
<span><span class="co">#&gt; QDM              :     0.858   ;    0.931   ;    0.755 </span></span>
<span><span class="co">#&gt; UQM              :     0.866   ;    0.933   ;    0.769 </span></span>
<span><span class="co">#&gt; SDM              :     0.877   ;    0.950   ;    0.775 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">rep_series</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ : num [1:1464, 1] 4.56 19.55 0 18.55 29.41 ...</span></span>
<span><span class="co">#&gt;  $ : num [1:1464] 4.55 19.55 0 18.55 29.41 ...</span></span>
<span><span class="co">#&gt;  $ : num [1:1464] 4.56 19.55 0 18.55 29.41 ...</span></span>
<span><span class="co">#&gt;  $ : num [1:1464] 4.55 19.55 0 18.55 29.41 ...</span></span>
<span><span class="co">#&gt;  $ : num [1:1464] 4.43 19.95 0 22.69 36.81 ...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-2">Example 2<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h2>
<p>Example 2 shows how to use the report function for specific bias
correction methods and projected periods. The Quantile Delta Mapping
(QDM), Unbiased Quantile Mapping (UQM), and Scaled Distribution Mapping
(SDM) methods will be reported. The report will analyze the projected
periods centered in 2035 2060 and 2080.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rep_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report</a></span><span class="op">(</span><span class="va">obs</span>, <span class="va">mod</span>, <span class="va">var</span>, fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"QDM"</span>, <span class="st">"UQM"</span>, <span class="st">"SDM"</span><span class="op">)</span>, </span>
<span>  y_init <span class="op">=</span> <span class="fl">1979</span>, y_wind <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2035</span>, <span class="fl">2060</span>, <span class="fl">2080</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Description of this report: </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Description of the table </span></span>
<span><span class="co">#&gt; The first line shows the difference (relative or absolute, according </span></span>
<span><span class="co">#&gt; to the variable analyzed) between the QM method and the observed data </span></span>
<span><span class="co">#&gt; in the historical period. For precipitation, a value of 1 means that </span></span>
<span><span class="co">#&gt; the mean precipitation of the observed data and QM series are the same </span></span>
<span><span class="co">#&gt; for the historical period. For temperature, this is achieved with a </span></span>
<span><span class="co">#&gt; value of 0. The second line shows the headers of the periods reported. </span></span>
<span><span class="co">#&gt; Remember that the moving window is centered in the period and its </span></span>
<span><span class="co">#&gt; length is equal to the length of the historical period. The first  </span></span>
<span><span class="co">#&gt; column (Hist.) shows the difference between the future and the </span></span>
<span><span class="co">#&gt; historical period. The next columns show the difference between the </span></span>
<span><span class="co">#&gt; corresponding period and the historical period. The third and the </span></span>
<span><span class="co">#&gt; following lines show the difference in each period for the </span></span>
<span><span class="co">#&gt; corresponding series. As a general rule, it is desirable that the </span></span>
<span><span class="co">#&gt; difference between the future periods and the historical period of the </span></span>
<span><span class="co">#&gt; bias corrected series match the differences of the modeled series. </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Description of the figures </span></span>
<span><span class="co">#&gt; Figure 1: (left) shows the cumulative distribution functions of each </span></span>
<span><span class="co">#&gt; series split between historical and future period. (right) shows the </span></span>
<span><span class="co">#&gt; observed, modeled, and corrected series. </span></span>
<span><span class="co">#&gt; Figure 2: shows the monthly mean of the historical and future period. </span></span>
<span><span class="co">#&gt; Additionally, monthly mean of the projected periods is displayed. </span></span>
<span><span class="co">#&gt; Figure 3: shows the monthly standard deviation of the historical and </span></span>
<span><span class="co">#&gt; future period. Additionally, monthly mean of the projected periods is </span></span>
<span><span class="co">#&gt; displayed. </span></span>
<span><span class="co">#&gt; * In Fig. 2 and 3, the obj (red) line represents objective values. </span></span>
<span><span class="co">#&gt; This objective series is computed as the observed series (monthly mean </span></span>
<span><span class="co">#&gt; or standard deviation), scaled by the variation between the projected </span></span>
<span><span class="co">#&gt; and the historical period of the modeled series. Each projected period </span></span>
<span><span class="co">#&gt; is centered in  a moving window whose length is equal to the length of </span></span>
<span><span class="co">#&gt; the historical period. </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Mean </span></span>
<span><span class="co">#&gt; QM performance in historical period  :     1.001 </span></span>
<span><span class="co">#&gt; Variation              Hist         2035         2060         2080 </span></span>
<span><span class="co">#&gt; Modeled          :     0.761   ;    0.893   ;    0.749   ;    0.657 </span></span>
<span><span class="co">#&gt; QDM              :     0.752   ;    0.883   ;    0.741   ;    0.656 </span></span>
<span><span class="co">#&gt; UQM              :     0.744   ;    0.881   ;    0.728   ;    0.644 </span></span>
<span><span class="co">#&gt; SDM              :     0.750   ;    0.880   ;    0.747   ;    0.646 </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Standard deviation </span></span>
<span><span class="co">#&gt; QM performance in historical period  :     0.990 </span></span>
<span><span class="co">#&gt; Variation              Hist         2035         2060         2080 </span></span>
<span><span class="co">#&gt; Modeled          :     0.843   ;    0.945   ;    0.830   ;    0.737 </span></span>
<span><span class="co">#&gt; QDM              :     0.858   ;    0.957   ;    0.857   ;    0.757 </span></span>
<span><span class="co">#&gt; UQM              :     0.866   ;    0.960   ;    0.865   ;    0.770 </span></span>
<span><span class="co">#&gt; SDM              :     0.877   ;    0.974   ;    0.886   ;    0.773 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">rep_series</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ : num [1:1464, 1] 4.55 19.55 0 18.55 29.41 ...</span></span>
<span><span class="co">#&gt;  $ : num [1:1464] 4.55 19.55 0 18.55 29.41 ...</span></span>
<span><span class="co">#&gt;  $ : num [1:1464] 4.56 19.55 0 18.55 29.41 ...</span></span>
<span><span class="co">#&gt;  $ : num [1:1464] 4.55 19.55 0 18.55 29.41 ...</span></span>
<span><span class="co">#&gt;  $ : num [1:1464] 4.43 19.95 0 22.69 36.81 ...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-3">Example 3<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h2>
<p>Example 3 shows how each bias correction method available in the
climQMBC package should be called. The outputs of each function are
columns vector with monthly corrected data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SDM比别人慢20倍</span></span>
<span><span class="va">frq</span> <span class="op">&lt;-</span> <span class="st">"M"</span> <span class="co">#' M' for monthly data; 'A' for annually data</span></span>
<span><span class="va">methods</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"QM"</span>, <span class="st">"DQM"</span>, <span class="st">"QDM"</span>, <span class="st">"UQM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_names</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># QM_series &lt;- QM(obs, mod, var, frq)</span></span>
<span><span class="co"># DQM_series &lt;- DQM(obs, mod, var, frq)</span></span>
<span><span class="co"># QDM_series &lt;- QDM(obs, mod, var, frq)</span></span>
<span><span class="co"># UQM_series &lt;- UQM(obs, mod, var, frq)</span></span>
<span><span class="co"># SDM_series &lt;- SDM(obs, mod, var, frq)</span></span>
<span></span>
<span><span class="va">lst</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">methods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">method</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">method</span><span class="op">)</span></span>
<span>  <span class="va">t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">fun</span><span class="op">(</span><span class="va">obs</span>, <span class="va">mod</span>, <span class="va">var</span>, <span class="va">frq</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">method</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">is.matrix</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="va">r</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="kw">else</span> <span class="va">r</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "QM"</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.012   0.000   0.012 </span></span>
<span><span class="co">#&gt; [1] "DQM"</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.032   0.000   0.033 </span></span>
<span><span class="co">#&gt; [1] "QDM"</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.557   0.023   0.759 </span></span>
<span><span class="co">#&gt; [1] "UQM"</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.527   0.026   0.726</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">lst</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>I <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># class(QM_series)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sebastian Aedo.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
